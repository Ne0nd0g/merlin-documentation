<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Command Line Flags &mdash; Merlin BETA documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=850acc4c"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="DLL Agent" href="dll.html" />
    <link rel="prev" title="Quick Start" href="../quickStart/quickstart.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Merlin
          </a>
              <div class="version">
                0.8.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">FAQ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq/faq.html">FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Quick Start</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickStart/quickstart.html">Quick Start</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Merlin Agent</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Command Line Flags</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#addr">addr</a></li>
<li class="toctree-l2"><a class="reference internal" href="#auth">auth</a></li>
<li class="toctree-l2"><a class="reference internal" href="#debug">debug</a></li>
<li class="toctree-l2"><a class="reference internal" href="#headers">headers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#host">host</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ja3">ja3</a></li>
<li class="toctree-l2"><a class="reference internal" href="#killdate">killdate</a></li>
<li class="toctree-l2"><a class="reference internal" href="#listener">listener</a></li>
<li class="toctree-l2"><a class="reference internal" href="#maxretry">maxretry</a></li>
<li class="toctree-l2"><a class="reference internal" href="#padding">padding</a></li>
<li class="toctree-l2"><a class="reference internal" href="#parrot">parrot</a></li>
<li class="toctree-l2"><a class="reference internal" href="#proto">proto</a></li>
<li class="toctree-l2"><a class="reference internal" href="#proxy">proxy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#psk">psk</a></li>
<li class="toctree-l2"><a class="reference internal" href="#skew">skew</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sleep">sleep</a></li>
<li class="toctree-l2"><a class="reference internal" href="#transforms">transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="#url">url</a></li>
<li class="toctree-l2"><a class="reference internal" href="#useragent">useragent</a></li>
<li class="toctree-l2"><a class="reference internal" href="#verbose">verbose</a></li>
<li class="toctree-l2"><a class="reference internal" href="#version">version</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dll.html">DLL Agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom.html">Custom Build</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Merlin CLI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cli/faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli/cli.html">Command Line Flags</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli/tls.html">TLS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli/listeners.html">Listeners</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli/commands.html">Command Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli/logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli/menu/main.html">Main Menu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli/menu/agents.html">Agent Menu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli/menu/listeners.html">Listener Menu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli/menu/modules.html">Modules Menu</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Merlin Server</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../server/server.html">Command Line Flags</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/x509.html">TLS Certificates</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules/build.html">Building Modules</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Misc.</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../misc/blogs.html">Blog Posts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/contrib.html">Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Merlin</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Command Line Flags</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/agent/cli.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="command-line-flags">
<h1>Command Line Flags<a class="headerlink" href="#command-line-flags" title="Link to this heading">ÔÉÅ</a></h1>
<p>The following command line flags can be used when executing Merlin agent:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Merlin Agent
  -addr string
        The address in interface:port format the agent will use for communications (default &quot;127.0.0.1:7777&quot;)
  -auth string
        The Agent&#39;s authentication method (e.g, OPAQUE (default &quot;opaque&quot;)
  -debug
        Enable debug output
  -headers string
        A new line separated (e.g., \n) list of additional HTTP headers to use
  -host string
        HTTP Host header
  -ja3 string
        JA3 signature string (not the MD5 hash). Overrides -proto flag
  -killdate string
        The date, as a Unix EPOCH timestamp, that the agent will quit running (default &quot;0&quot;)
  -listener string
        The uuid of the peer-to-peer listener this agent should connect to
  -maxretry string
        The maximum amount of failed checkins before the agent will quit running (default &quot;7&quot;)
  -padding string
        The maximum amount of data that will be randomly selected and appended to every message (default &quot;4096&quot;)
  -parrot string
    parrot or mimic a specific browser from github.com/refraction-networking/utls (e.g., HelloChrome_Auto)
  -proto string
        Protocol for the agent to connect with [https (HTTP/1.1), http (HTTP/1.1 Clear-Text), h2 (HTTP/2), h2c (HTTP/2 Clear-Text), http3 (QUIC or HTTP/3.0), tcp-bind, tcp-reverse, udp-bind, udp-reverse, smb-bind] (default &quot;h2&quot;)
  -proxy string
        Hardcoded proxy to use for http/1.1 traffic only that will override host configuration
  -psk string
        Pre-Shared Key used to encrypt initial communications (default &quot;merlin&quot;)
  -secure string
        Require TLS certificate validation for HTTP communications (default &quot;false&quot;)
  -skew string
        Amount of skew, or variance, between agent checkins (default &quot;3000&quot;)
  -sleep string
        Time for agent to sleep (default &quot;30s&quot;)
  -transforms string
        Ordered CSV of transforms to construct a message (default &quot;jwe,gob-base&quot;)
  -url string
        A comma separated list of the full URLs for the agent to connect to (default &quot;https://127.0.0.1:443&quot;)
  -useragent string
        The HTTP User-Agent header string that the Agent will use while sending traffic (default &quot;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.85 Safari/537.36&quot;)
  -v    Enable verbose output
  -version
        Print the agent version and exit
</pre></div>
</div>
<section id="addr">
<h2>addr<a class="headerlink" href="#addr" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">-addr</span></code> flag is only used for peer-to-peer agents to specify what network address they should connect or bind to,
depending on the selected protocol. For example, <code class="docutils literal notranslate"><span class="pre">tcp-bind</span></code> will bind to the specified address and
<code class="docutils literal notranslate"><span class="pre">tcp-reverse</span></code> will connect to the specified address.</p>
</section>
<section id="auth">
<h2>auth<a class="headerlink" href="#auth" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">-auth</span></code> flag specifies what authentication protocol the Merlin Agent will use to communicate with the server.
The default value is <code class="docutils literal notranslate"><span class="pre">opaque</span></code>.
The <code class="docutils literal notranslate"><span class="pre">none</span></code> value can be used to disable Agent authentication.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This value must match the listener‚Äôs configuration on the server</p>
</div>
</section>
<section id="debug">
<h2>debug<a class="headerlink" href="#debug" title="Link to this heading">ÔÉÅ</a></h2>
<p>By default, the Merlin Agent will not write anything to STDOUT while it is running.
The <code class="docutils literal notranslate"><span class="pre">-debug</span></code> flag enables debug output and facilitates troubleshooting to identify the source of a problem.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Windows Agents must have been compiled with debug enabled or else there will be no console window to see</p>
</div>
</section>
<section id="headers">
<h2>headers<a class="headerlink" href="#headers" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">-headers</span></code> flag is used to additional HTTP headers to add to every message.
The headers are provided as a string and must be separated by a new line (<code class="docutils literal notranslate"><span class="pre">\n</span></code>).
For example, <code class="docutils literal notranslate"><span class="pre">-headers</span> <span class="pre">&quot;X-Header1:</span> <span class="pre">Value1\nX-Header2:</span> <span class="pre">Value2&quot;</span></code>.</p>
</section>
<section id="host">
<h2>host<a class="headerlink" href="#host" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">-host</span></code> flag is used to specify the HTTP <em>Host:</em> header when communicating with the server.
This feature is predominately used for <a class="reference external" href="https://attack.mitre.org/techniques/T1090/004/">Domain Fronting</a>.</p>
</section>
<section id="ja3">
<h2>ja3<a class="headerlink" href="#ja3" title="Link to this heading">ÔÉÅ</a></h2>
<p><a class="reference external" href="https://engineering.salesforce.com/tls-fingerprinting-with-ja3-and-ja3s-247362855967">JA3 is a method for fingerprinting TLS clients on the wire</a>.
Every TLS client has a unique signature depending on its configuration of the following TLS options:
<code class="docutils literal notranslate"><span class="pre">SSLVersion,Ciphers,Extensions,EllipticCurves,EllipticCurvePointFormats</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">-ja3</span></code> flag allows the agent to create a TLS client based on the provided JA3 hash signature.
This is useful to evade detections based on a JA3 hash for a known tool (i.e. Merlin).
<a class="reference external" href="https://engineering.salesforce.com/gquic-protocol-analysis-and-fingerprinting-in-zeek-a4178855d75f">This</a> article
documents a JA3 fingerprint for Merlin. Known JA3 signatures can be downloaded from <a class="reference external" href="https://ja3er.com/">https://ja3er.com/</a></p>
<p><strong>NOTE:</strong> Make sure the input JA3 hash will enable communications with the Server. For example, if you leverage a JA3
hash that only supports SSLv2 and the server does not support that protocol, then they will not be able to communicate.
The <code class="docutils literal notranslate"><span class="pre">-ja3</span></code> flag will override the the <code class="docutils literal notranslate"><span class="pre">-proto</span></code> flag and will cause the agent to use the protocol provided in the JA3 hash.</p>
</section>
<section id="killdate">
<h2>killdate<a class="headerlink" href="#killdate" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">-killdate</span></code> flag is used to specify the date, as an Unix epoch timestamp, that the agent should quit running.
<a class="reference external" href="https://www.epochconverter.com">EpochConverter</a> is a good resource to generate or convert a timestamp.
The default value is <code class="docutils literal notranslate"><span class="pre">0</span></code> which means the Agent does not have a killdate.</p>
</section>
<section id="listener">
<h2>listener<a class="headerlink" href="#listener" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">-listener</span></code> flag is used to specify the UUID of the <strong>LISTENER</strong> that the peer-to-peer Agent is configured to connect to.
The Agent‚Äôs configuration must match the Listener‚Äôs configuration on the server.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the listener‚Äôs UUID is not provided, the Agent will not run</p>
</div>
</section>
<section id="maxretry">
<h2>maxretry<a class="headerlink" href="#maxretry" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">-maxretry</span></code> flag is the maximum amount of failed checkins before the agent will quit running. The default value is 7.</p>
</section>
<section id="padding">
<h2>padding<a class="headerlink" href="#padding" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">-padding</span></code> flag is maximum amount of data that will be randomly selected and appended to every message.
The default value is 4096 bytes. The data padding is intended to increase the detection difficulty for idle checkin
behavior when the message size was fixed everytime.</p>
</section>
<section id="parrot">
<h2>parrot<a class="headerlink" href="#parrot" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">-parrot</span></code> flag is used to configure the HTTP TLS client to parrot or mimic a specific browser.
This setting will override the <code class="docutils literal notranslate"><span class="pre">-ja3</span></code> flag.
Examples of some supported values are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">HelloChrome_Auto</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HelloChrome_102</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HelloGolang</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HelloFirefox_Auto</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HelloIOS_Auto</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HelloEdge_Auto</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HelloSafari_Auto</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Hello360_Auto</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HelloQQ_Auto</span></code></p></li>
</ul>
<p>A full list of options can be found in the <code class="docutils literal notranslate"><span class="pre">u_common.go</span></code> in the <a class="reference external" href="https://github.com/refraction-networking/utls/tree/master">utls library</a>.</p>
</section>
<section id="proto">
<h2>proto<a class="headerlink" href="#proto" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">-proto</span></code> flag specifies what protocol the Merlin Agent will use to communicate with the server</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">http</span></code> protocol communicates using the clear-text HTTP/1.1 protocol. This can be useful when leveraging Domain Fronting on a CDN that does not allow both fronting and TLS encrypted traffic.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">https</span></code> protocol communicates using SSL/TLS encrypted HTTP/1.1 protocol.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">h2c</span></code> protocol communicates using the clear-text HTTP/2 protocol. This clear-text version is not used by web browsers like Chrome and may stand out during traffic analysis. However, it also has the potential to evade detections if allowed out of the network and no network defenses are able to parse the traffic.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">h2</span></code> protocol communicates using the TLS encrypted HTTP/2 protocol. This will start the connection with prior knowledge and will not negotiate from HTTP/1.1 to HTTP/2. Some web proxies will not allow HTTP/2 communications. In this case you should use <code class="docutils literal notranslate"><span class="pre">https</span></code>. Alternatively, the HTTP/2 protocol <em>might</em> bypass network defenses or detections.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">http3</span></code> protocol communicates using HTTP/2 transported over <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-quic-transport-28">QUIC</a> known as <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-quic-http-29">HTTP/3</a>. It is important to note that QUIC is a UDP protocol and may not be allowed of the network depending on egress filtering. QUIC uses TLS transport encryption.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tcp-bind</span></code> protocol is for peer-to-peer agents to bind to a TCP port and wait for a connection from a parent Agent</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tcp-reverse</span></code> protocol is for peer-to-peer agents to connect to a TCP port on a parent Agent</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">udp-bind</span></code> protocol is for peer-to-peer agents to bind to a UDP port and wait for a connection from a parent Agent</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">udp-reverse</span></code> protocol is for peer-to-peer agents to connect to a UDP port on a parent Agent</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">smb-bind</span></code> protocol is for peer-to-peer agents to bind to a SMB named pipe and wait for a connection from a parent Agent</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">smb-reverse</span></code> protocol is for peer-to-peer agents to connect to a SMB named pipe on a parent Agent</p></li>
</ul>
</section>
<section id="proxy">
<h2>proxy<a class="headerlink" href="#proxy" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">-proxy</span></code> flag is used to force HTTP/1.1 communications to go through a known proxy.
At this time the Merlin Agent <strong>WILL NOT</strong> automatically detect if a host is configured to use a proxy.
The HTTP/2 protocol does not support using a proxy. If a proxy is required to egress a network,
use the <code class="docutils literal notranslate"><span class="pre">http</span></code> or <code class="docutils literal notranslate"><span class="pre">https</span></code> protocols.</p>
</section>
<section id="psk">
<h2>psk<a class="headerlink" href="#psk" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">-psk</span></code> flag is used to specify the Pre-Shared Key (PSK) that the Merlin Agent uses to initiate communication with
the Merlin Server. The first message is encrypted with the PSK and subsequent messages establish a new session based
encryption key using the <a class="reference external" href="https://eprint.iacr.org/2018/163.pdf">OPAQUE protocol</a> from
<a class="reference external" href="https://tools.ietf.org/html/draft-krawczyk-cfrg-opaque-03">this</a> IETF draft.
Additional information about OPAQUE can be found here:
<a class="reference external" href="https://posts.specterops.io/merlin-goes-opaque-for-key-exchange-420db3a58713">Merlin Goes OPAQUE for Key Exchange</a>.</p>
</section>
<section id="skew">
<h2>skew<a class="headerlink" href="#skew" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">-skew</span></code> flag is the amount of skew, or variance, between agent checkins. The default value is 3000</p>
</section>
<section id="sleep">
<h2>sleep<a class="headerlink" href="#sleep" title="Link to this heading">ÔÉÅ</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You must include the unit of measurement after the number (e.g. 30s or 1m)</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">-sleep</span></code> flag is used to specify how long the agent will sleep between checkin attempts.
For example, <code class="docutils literal notranslate"><span class="pre">30s</span></code> is for thirty seconds and <code class="docutils literal notranslate"><span class="pre">1m</span></code> is for one minute.</p>
<p>Peer-to-peer bind and reverse Agents can be configured with a negative sleep value (e.g., -10s).
The actual amount doesn‚Äôt matter, just that it is negative.
A negative sleep value prevents the peer-to-peer Agent from communicating on the network UNLESS it has a job.
This means there are no status checkin messages back to the Server at a fixed interval.</p>
</section>
<section id="transforms">
<h2>transforms<a class="headerlink" href="#transforms" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">-transforms</span></code> flag is used to specify the ordered list of transforms that will be used to construct/deconstruct a message.
The default value is <code class="docutils literal notranslate"><span class="pre">jwe,gob-base</span></code>. The transforms are applied in the order they are specified.
The value provided to the <code class="docutils literal notranslate"><span class="pre">-transforms</span></code> flag <strong>MUST</strong> match the listener‚Äôs configuration or the Agent will fail to connect.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">gob-base</span></code> transform must be the last transform in the list to unmarshall into a Go structure</p>
</div>
<p>Available transforms consist of encoders and encrypters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> - AES encrypt/decrypt the data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">base64-byte</span></code> - Encode/decode the data to/from base64 as bytes using the <a class="reference external" href="https://pkg.go.dev/encoding/base64#Encoding.EncodedLen">EncodeLen()</a> function</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">base64-string</span></code> - Encode/decode the data to/from base64 as a string using the <a class="reference external" href="https://pkg.go.dev/encoding/base64#Encoding.EncodeToString">EncodeToString()</a> function</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hex-byte</span></code> - Encode/decode the data to/from hex as bytes using the <a class="reference external" href="https://pkg.go.dev/encoding/hex#EncodedLen">EncodeLen</a> function</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hex-string</span></code> - Encode/decode the data to/from hex as a string using the <a class="reference external" href="https://pkg.go.dev/encoding/hex#EncodeToString">EncodeToString</a> function</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gob-base</span></code> - Gob encode/decode the message in to a <a class="reference external" href="https://github.com/Ne0nd0g/merlin-message/blob/main/messages.go">Merlin Base</a> message structure</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gob-string</span></code> - Gob encode/decode the message in to a string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jwe</span></code> - Encode/decode the data into a <a class="reference external" href="https://www.rfc-editor.org/info/rfc7516">JSON Web Encryption (RFC 7516)</a> structure</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rc4</span></code> - Encode/decode the data using the RC4 stream cipher</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">xor</span></code> - Encode/decode the data using the XOR cipher</p></li>
</ul>
<p>The JWE transform uses the following configuration:</p>
<ul class="simple">
<li><p>Encrypter: <code class="docutils literal notranslate"><span class="pre">A256GCM</span></code></p></li>
<li><p>Algorithm: <code class="docutils literal notranslate"><span class="pre">PBES2_HS512_A256KW</span></code></p></li>
<li><p>PBES2Count: <code class="docutils literal notranslate"><span class="pre">3000</span></code></p></li>
</ul>
</section>
<section id="url">
<h2>url<a class="headerlink" href="#url" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">-url</span></code> flag is used to specify the Uniformed Resource Locator (URL) that the agent will attempt to communicate with.
Include the protocol (i.e. <code class="docutils literal notranslate"><span class="pre">https</span></code>), the host (i.e. <code class="docutils literal notranslate"><span class="pre">127.0.0.1</span></code>), the page (i.e <code class="docutils literal notranslate"><span class="pre">/</span></code> or <code class="docutils literal notranslate"><span class="pre">/news.php</span></code>),
and optionally port (i.e. <code class="docutils literal notranslate"><span class="pre">:443</span></code>).
This will result in <code class="docutils literal notranslate"><span class="pre">https://127.0.0.1:443/</span></code>.
<strong>NOTE:</strong> By default the Merlin agent will communicate on the loopback adapter.</p>
</section>
<section id="useragent">
<h2>useragent<a class="headerlink" href="#useragent" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">-useragent</span></code> flag is the HTTP User-Agent header string that the Agent will use while sending traffic.
The default value is: <code class="docutils literal notranslate"><span class="pre">Mozilla/5.0</span> <span class="pre">(Windows</span> <span class="pre">NT</span> <span class="pre">6.1;</span> <span class="pre">Win64;</span> <span class="pre">x64)</span> <span class="pre">AppleWebKit/537.36</span> <span class="pre">(KHTML,</span> <span class="pre">like</span> <span class="pre">Gecko)</span> <span class="pre">Chrome/40.0.2214.85</span> <span class="pre">Safari/537.36</span></code>.</p>
</section>
<section id="verbose">
<h2>verbose<a class="headerlink" href="#verbose" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">-v</span></code> flag enables verbose output. By default a running Merlin Agent will not write any information to STDOUT.
This can be used to see what the agent is doing along with what commands it is receiving.</p>
</section>
<section id="version">
<h2>version<a class="headerlink" href="#version" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">-version</span></code> flag will print the Agent version to the screen and then exit.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../quickStart/quickstart.html" class="btn btn-neutral float-left" title="Quick Start" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dll.html" class="btn btn-neutral float-right" title="DLL Agent" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Russel Van Tuyl (@Ne0nd0g).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>